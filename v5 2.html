<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HealthLab - Functional Mockup (Web)</title>

  <!-- Fonts + Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    :root{
      --primary:#00BFA6;
      --primary-dark:#00A693;
      --bg:#f8f9fb;
      --card:#ffffff;
      --text:#1a1a1a;
      --muted:#666;
      --soft:#f5f6fa;
      --border:#f0f0f0;
      --danger:#FF4757;
      --warning:#f7b731;
      --info:#45B7D1;
      --shadow:0 10px 30px rgba(0,0,0,0.08);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);
    }
    a{color:inherit;text-decoration:none}
    button{font-family:inherit}
    input,select,textarea{font-family:inherit}

    /* App container (mobile width) */
    .mobile-container{
      max-width:400px;margin:0 auto;min-height:100vh;background:#fff;position:relative;
      box-shadow:0 0 40px rgba(0,0,0,0.1);overflow:hidden;
    }

    .content-wrapper{padding-bottom:80px}
    .hidden{display:none !important}
    .screen{min-height:100vh;background:#fff}
    .soft-bg{background:linear-gradient(135deg,#ffffff 0%, #f8f9fb 100%)}

    /* Header */
    .header{
      padding:20px;background:linear-gradient(135deg,#ffffff 0%, #f8f9fb 100%);
    }
    .header-top{
      display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;
    }
    .location{display:flex;align-items:center;gap:8px;color:#666;font-size:14px}
    .location i{color:var(--primary)}
    .header-icons{display:flex;gap:14px}
    .header-icons i{font-size:20px;color:#333;cursor:pointer}
    .notification-badge{position:relative}
    .notification-badge[data-count]:after{
      content:attr(data-count);
      position:absolute;top:-6px;right:-8px;background:var(--danger);color:#fff;
      font-size:10px;padding:2px 6px;border-radius:10px;line-height:1;
    }
    .greeting h1{font-size:26px;font-weight:700;margin-bottom:6px}
    .greeting p{color:#666;font-size:14px}

    /* Search */
    .search-container{padding:0 20px 18px}
    .search-bar{
      background:var(--soft);border-radius:12px;padding:12px 16px;
      display:flex;gap:10px;align-items:center;border:1px solid #eef0f3
    }
    .search-bar i{color:#999}
    .search-bar input{flex:1;border:none;outline:none;background:transparent;font-size:15px}

    /* Buttons */
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      padding:12px 16px;border:none;border-radius:12px;font-weight:600;cursor:pointer;transition:.2s;
    }
    .btn:active{transform:scale(0.99)}
    .btn-primary{background:#fff;color:var(--primary);box-shadow:0 5px 15px rgba(0,0,0,0.08)}
    .btn-solid{background:var(--primary);color:#fff}
    .btn-outline{background:#fff;color:var(--primary);border:1px solid var(--primary)}
    .btn-muted{background:var(--soft);color:#333}
    .btn-danger{background:var(--danger);color:#fff}
    .btn-link{background:transparent;color:var(--primary);padding:8px}

    /* Quick actions */
    .quick-actions{
      padding:0 20px 20px;display:grid;grid-template-columns:repeat(4,1fr);gap:14px;
    }
    .action-item{text-align:center;cursor:pointer;transition:.2s}
    .action-item:hover{transform:translateY(-3px)}
    .action-icon{
      width:60px;height:60px;border-radius:16px;margin:0 auto 8px;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(135deg,#f5f6fa 0%, #e9ecef 100%);font-size:22px;color:#333
    }
    .action-item[data-variant="1"] .action-icon{background:linear-gradient(135deg,#FF6B6B 0%, #FF8E8E 100%);color:#fff}
    .action-item[data-variant="2"] .action-icon{background:linear-gradient(135deg,#4ECDC4 0%, #6EE2D9 100%);color:#fff}
    .action-item[data-variant="3"] .action-icon{background:linear-gradient(135deg,#45B7D1 0%, #68C8DD 100%);color:#fff}
    .action-item[data-variant="4"] .action-icon{background:linear-gradient(135deg,#F7B731 0%, #F9C851 100%);color:#fff}
    .action-item span{font-size:12px;color:#666;font-weight:600}

    /* Promo */
    .promo-banner{
      margin:0 20px 20px;border-radius:20px;padding:20px;color:#fff;position:relative;overflow:hidden;
      background:linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);box-shadow:0 10px 30px rgba(0,191,166,.25)
    }
    .promo-decoration{
      position:absolute;right:-40px;top:-50px;width:140px;height:140px;background:rgba(255,255,255,0.12);border-radius:50%;
    }
    .promo-content h3{font-size:19px;font-weight:700;margin-bottom:8px}
    .promo-content p{font-size:13px;opacity:.9;margin-bottom:12px}

    /* Sections headers */
    .section-header{
      padding:0 20px;display:flex;justify-content:space-between;align-items:center;margin:8px 0 14px;
    }
    .section-header h2{font-size:18px;font-weight:700}
    .see-all{color:var(--primary);font-size:14px;font-weight:600}

    /* Cards and grids */
    .test-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;padding:0 20px 20px}
    .card{
      background:#fff;border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 12px rgba(0,0,0,0.04);transition:.2s;
    }
    .card:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,0.08)}
    .test-card{padding:14px;cursor:pointer}
    .test-icon{
      width:40px;height:40px;border-radius:12px;margin-bottom:10px;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(135deg,#f5f6fa 0%, #e9ecef 100%);font-size:18px;color:#333
    }
    .test-name{font-weight:700;font-size:14px;margin-bottom:6px}
    .test-info{display:flex;justify-content:space-between;align-items:center}
    .test-price{color:var(--primary);font-weight:700}
    .test-time{font-size:12px;color:#999}

    /* Packages scroll */
    .packages-scroll{display:flex;gap:14px;overflow-x:auto;padding:0 20px 20px;scrollbar-width:none}
    .packages-scroll::-webkit-scrollbar{display:none}
    .package-card{
      min-width:280px;color:#fff;border-radius:20px;padding:18px;position:relative;overflow:hidden;
      background:linear-gradient(135deg,#667eea 0%, #764ba2 100%);
    }
    .package-card.secondary{background:linear-gradient(135deg,#f093fb 0%, #f5576c 100%)}
    .package-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
    .package-title h3{font-size:18px;font-weight:700;margin-bottom:4px}
    .package-title p{font-size:12px;opacity:.9}
    .package-price{text-align:right}
    .package-price .original{font-size:12px;text-decoration:line-through;opacity:.8}
    .package-price .discounted{font-size:20px;font-weight:800}
    .package-features{margin-top:10px}
    .package-features li{list-style:none;font-size:13px;margin:8px 0;display:flex;align-items:center;gap:8px}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:11px;font-weight:700}
    .badge-soft{background:var(--soft);color:#333;border:1px solid #eef0f3}

    /* Forms */
    .form{padding:20px}
    .form-group{margin-bottom:14px}
    .form-label{display:block;font-size:13px;color:#555;margin-bottom:6px;font-weight:600}
    .input{
      width:100%;padding:12px 14px;border-radius:12px;border:1px solid #e6e8ec;background:#fff;outline:none;
      font-size:14px;transition:.15s;
    }
    .input:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(0,191,166,0.12)}
    .input-row{display:flex;gap:10px}
    .helper{font-size:12px;color:#888;margin-top:6px}
    .checkbox{display:flex;align-items:center;gap:10px;font-size:13px;color:#333}
    .cta-bar{position:sticky;bottom:80px;left:0;right:0;padding:12px 20px;background:linear-gradient(to top,#fff 85%, rgba(255,255,255,0));}

    /* Top bars for simple pages */
    .topbar{
      position:sticky;top:0;background:#fff;z-index:5;border-bottom:1px solid var(--border);
      display:flex;align-items:center;gap:12px;padding:14px 16px;
    }
    .topbar .back{width:36px;height:36px;border-radius:10px;background:var(--soft);display:flex;align-items:center;justify-content:center}
    .topbar-title{font-weight:800;font-size:16px}

    /* Bottom Nav */
    .bottom-nav{
      position:fixed;left:50%;transform:translateX(-50%);bottom:0;width:100%;max-width:400px;
      background:#fff;padding:8px 0;border-top:1px solid var(--border);box-shadow:0 -4px 20px rgba(0,0,0,0.05);z-index:10
    }
    .nav-items{display:flex;justify-content:space-around;align-items:center}
    .nav-item{text-align:center;padding:8px 6px;cursor:pointer}
    .nav-item i{font-size:22px;color:#999;margin-bottom:3px;display:block}
    .nav-item span{font-size:11px;color:#999;display:block;font-weight:600}
    .nav-item.active i,.nav-item.active span{color:var(--primary)}

    /* Pills/Tabs */
    .tabs{display:flex;gap:8px;padding:0 20px 10px}
    .tab{padding:10px 12px;border-radius:999px;border:1px solid #e6e8ec;background:#fff;font-size:13px;cursor:pointer}
    .tab.active{background:var(--primary);border-color:var(--primary);color:#fff}

    /* Lists */
    .list{padding:10px 20px 90px;display:flex;flex-direction:column;gap:12px}
    .list-item{background:#fff;border:1px solid var(--border);border-radius:14px;padding:14px;display:flex;gap:12px}
    .list-item .icon{width:44px;height:44px;border-radius:12px;background:var(--soft);display:flex;align-items:center;justify-content:center;color:#555}
    .list-item .content{flex:1}
    .list-item .title{font-weight:700;font-size:14px;margin-bottom:4px}
    .list-item .subtitle{font-size:12px;color:#666}

    /* Chips */
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{padding:8px 10px;border-radius:999px;border:1px solid #e6e8ec;background:#fff;font-size:12px}
    .chip.active{border-color:var(--primary);color:var(--primary);font-weight:700}

    /* Calendar/slots (simple) */
    .calendar{padding:0 20px 10px;display:flex;gap:8px;overflow-x:auto}
    .calendar .day{
      min-width:66px;text-align:center;border:1px solid #e6e8ec;background:#fff;border-radius:12px;padding:10px;cursor:pointer
    }
    .calendar .day.active{border-color:var(--primary);box-shadow:0 0 0 3px rgba(0,191,166,.12)}
    .slots{padding:0 20px 20px;display:flex;flex-wrap:wrap;gap:8px}
    .slot{padding:10px 12px;border-radius:10px;border:1px solid #e6e8ec;background:#fff;cursor:pointer;font-size:13px}
    .slot.selected{background:var(--primary);border-color:var(--primary);color:#fff;font-weight:700}

    /* Modal (simple) */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.4);display:none;align-items:flex-end;justify-content:center;z-index:100}
    .modal{width:100%;max-width:400px;background:#fff;border-radius:18px 18px 0 0;padding:16px 16px 20px}
    .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .modal-title{font-weight:800}
    .close{width:36px;height:36px;border-radius:10px;background:var(--soft);display:flex;align-items:center;justify-content:center;cursor:pointer}

    /* Splash */
    .splash{
      min-height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:18px;
      background:radial-gradient( circle at 20% 20%, #ffffff 0, #f8f9fb 45%, #eef2f4 100%);
    }
    .logo-badge{
      width:90px;height:90px;border-radius:24px;background:linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 20px 40px rgba(0,191,166,.35);font-size:38px;
      animation:pop 650ms ease-out;
    }
    @keyframes pop{0%{transform:scale(.7);opacity:.0}60%{transform:scale(1.05)}100%{transform:scale(1);opacity:1}}

    /* Onboarding */
    .onboarding{padding:20px;display:flex;flex-direction:column;gap:16px}
    .slides{position:relative;height:300px;background:linear-gradient(135deg,#f5f6fa 0%, #e9ecef 100%);border-radius:20px;overflow:hidden;display:flex;align-items:center;justify-content:center}
    .slide{position:absolute;inset:0;display:none;align-items:center;justify-content:center;padding:24px;text-align:center}
    .slide.active{display:flex;animation:fade .4s}
    @keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    .slide h3{font-size:20px;font-weight:800;margin-bottom:8px}
    .slide p{font-size:14px;color:#555}
    .dots{display:flex;gap:6px;justify-content:center}
    .dot{width:8px;height:8px;border-radius:50%;background:#d8dde3}
    .dot.active{background:var(--primary)}

    /* OTP inputs */
    .otp{display:flex;gap:8px;justify-content:center}
    .otp input{width:40px;height:48px;text-align:center;font-size:18px;border-radius:12px;border:1px solid #e6e8ec;outline:none}
    .otp input:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(0,191,166,.12)}

    /* Empty states */
    .empty{padding:40px 20px;text-align:center;color:#666}
    .empty i{font-size:36px;color:#c9ced6;margin-bottom:10px}

    /* Toast */
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:90px;background:#111;color:#fff;padding:10px 14px;border-radius:10px;font-size:13px;opacity:0;pointer-events:none;transition:.25s;z-index:50}
    .toast.show{opacity:1;transform:translate(-50%,-6px)}
  </style>
</head>
<body>
  <div class="mobile-container">
    <div id="app" class="content-wrapper">

      <!-- Splash -->
      <section id="splash" class="screen splash">
        <div class="logo-badge"><i class="fa-solid fa-flask"></i></div>
        <div style="text-align:center">
          <h1 style="font-size:22px;font-weight:800;margin-bottom:6px">HealthLab</h1>
          <p style="color:#666">Diagnostics made simple</p>
        </div>
      </section>

      <!-- Onboarding -->
      <section id="onboarding" class="screen hidden">
        <div class="topbar">
          <div style="flex:1"></div>
          <button class="btn btn-link" data-route="#login">Skip</button>
        </div>
        <div class="onboarding">
          <div class="slides" id="slides">
            <div class="slide active">
              <div>
                <div class="logo-badge" style="width:70px;height:70px;font-size:28px;margin:0 auto 12px"><i class="fa-solid fa-heart-pulse"></i></div>
                <h3>Welcome to HealthLab</h3>
                <p>Book tests, view reports, and manage your health from one place.</p>
              </div>
            </div>
            <div class="slide">
              <div>
                <div class="logo-badge" style="width:70px;height:70px;font-size:28px;margin:0 auto 12px;background:linear-gradient(135deg,#4ECDC4 0%, #6EE2D9 100%)"><i class="fa-solid fa-vial"></i></div>
                <h3>Key Features</h3>
                <p>Home collection, easy payments, offers, and detailed health packages.</p>
              </div>
            </div>
            <div class="slide">
              <div>
                <div class="logo-badge" style="width:70px;height:70px;font-size:28px;margin:0 auto 12px;background:linear-gradient(135deg,#45B7D1 0%, #68C8DD 100%)"><i class="fa-solid fa-file-medical"></i></div>
                <h3>How it Works</h3>
                <p>Search a test, pick a slot, pay, and get your reports online.</p>
              </div>
            </div>
          </div>
          <div class="dots" id="dots">
            <div class="dot active"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>
          <div style="display:flex;gap:10px;justify-content:space-between;margin-top:8px">
            <button class="btn btn-muted" id="prevSlide"><i class="fa-solid fa-chevron-left"></i> Back</button>
            <button class="btn btn-solid" id="nextSlide">Next <i class="fa-solid fa-chevron-right"></i></button>
          </div>
        </div>
      </section>

      <!-- Login -->
      <section id="login" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#onboarding"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Login</div>
        </div>
        <div class="form">
          <div class="form-group">
            <label class="form-label">Phone Number</label>
            <div class="input-row">
              <select class="input" id="countryCode" style="max-width:110px">
                <option value="+91">+91 IN</option>
                <option value="+1">+1 US</option>
                <option value="+971">+971 AE</option>
              </select>
              <input id="phone" class="input" placeholder="Enter phone number" type="tel" maxlength="15"/>
            </div>
            <div class="helper">We will send a 6-digit OTP</div>
          </div>
          <div class="form-group checkbox">
            <input id="terms" type="checkbox"/>
            <label for="terms">I agree to the Terms & Privacy</label>
          </div>
          <button id="loginContinue" class="btn btn-solid" style="width:100%">Continue</button>
          <div style="text-align:center;margin-top:12px">
            <a class="btn-link" data-route="#register">New user? Register</a>
          </div>
        </div>
      </section>

      <!-- OTP -->
      <section id="otp" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#login"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Verify OTP</div>
        </div>
        <div class="form" style="text-align:center">
          <p class="helper" id="otpPhoneLabel">Enter the 6-digit code sent to your phone</p>
          <div class="otp" style="margin:14px 0">
            <input maxlength="1" inputmode="numeric">
            <input maxlength="1" inputmode="numeric">
            <input maxlength="1" inputmode="numeric">
            <input maxlength="1" inputmode="numeric">
            <input maxlength="1" inputmode="numeric">
            <input maxlength="1" inputmode="numeric">
          </div>
          <div class="helper" id="otpTimer">Resend in 30s</div>
          <div style="margin-top:14px;display:flex;gap:10px;justify-content:center">
            <button class="btn btn-muted" id="resendOtp" disabled>Resend OTP</button>
            <button class="btn btn-solid" id="verifyOtp">Verify</button>
          </div>
        </div>
      </section>

      <!-- Register -->
      <section id="register" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#login"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Create Account</div>
        </div>
        <div class="form">
          <div class="form-group"><label class="form-label">Full Name</label><input id="regName" class="input" placeholder="Your full name"/></div>
          <div class="form-group"><label class="form-label">Email (optional)</label><input id="regEmail" class="input" placeholder="you@example.com" type="email"/></div>
          <div class="form-group"><label class="form-label">Date of Birth</label><input id="regDob" class="input" type="date"/></div>
          <div class="form-group">
            <label class="form-label">Gender</label>
            <div class="chips" id="regGender">
              <div class="chip">Male</div>
              <div class="chip">Female</div>
              <div class="chip">Other</div>
            </div>
          </div>
          <div class="form-group"><label class="form-label">Address</label><input id="regAddress" class="input" placeholder="Flat, street, city"/></div>
          <div class="cta-bar">
            <button id="registerSubmit" class="btn btn-solid" style="width:100%">Submit</button>
          </div>
        </div>
      </section>

      <!-- Location Permission -->
      <section id="location" class="screen hidden">
        <div class="topbar">
          <div class="topbar-title" style="padding-left:8px">Location Access</div>
        </div>
        <div class="form" style="text-align:center">
          <div class="logo-badge" style="width:72px;height:72px;margin:10px auto 10px"><i class="fa-solid fa-location-dot"></i></div>
          <h3 style="font-size:18px;font-weight:800;margin-bottom:8px">Enable Location</h3>
          <p class="helper" style="margin:0 14px">We use your location to show nearby labs and available home collection slots.</p>
          <div style="margin-top:18px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
            <button id="allowLocation" class="btn btn-solid"><i class="fa-solid fa-check"></i> Allow</button>
            <button id="denyLocation" class="btn btn-muted"><i class="fa-solid fa-xmark"></i> Deny</button>
            <button data-route="#home" class="btn btn-link">Skip</button>
          </div>
        </div>
      </section>

      <!-- Home -->
      <section id="home" class="screen hidden">
        <div class="header">
          <div class="header-top">
            <div class="location"><i class="fa-solid fa-map-marker-alt"></i> <span id="currentCity">Your location</span></div>
            <div class="header-icons">
              <div class="notification-badge" id="notifBtn" data-count="3"><i class="fa-solid fa-bell"></i></div>
              <i class="fa-solid fa-user-circle" data-route="#profile"></i>
            </div>
          </div>
          <div class="greeting">
            <h1 id="greetingTitle">Hi there! 👋</h1>
            <p>How can we help you today?</p>
          </div>
        </div>

        <div class="search-container">
          <div class="search-bar">
            <i class="fa-solid fa-search"></i>
            <input id="searchInput" type="text" placeholder="Search for tests, packages..." />
            <i class="fa-solid fa-microphone"></i>
          </div>
        </div>

        <div class="quick-actions">
          <div class="action-item" data-variant="1" data-route="#search">
            <div class="action-icon"><i class="fa-solid fa-vial"></i></div><span>Book Test</span>
          </div>
          <div class="action-item" data-variant="2" data-route="#collection-type">
            <div class="action-icon"><i class="fa-solid fa-house"></i></div><span>Home Visit</span>
          </div>
          <div class="action-item" data-variant="3" data-route="#reports">
            <div class="action-icon"><i class="fa-solid fa-file-medical"></i></div><span>Reports</span>
          </div>
          <div class="action-item" data-variant="4" data-route="#upload-rx">
            <div class="action-icon"><i class="fa-solid fa-prescription"></i></div><span>Upload Rx</span>
          </div>
        </div>

        <div class="promo-banner">
          <div class="promo-decoration"></div>
          <div class="promo-content">
            <h3>Get 30% OFF on Full Body Checkup</h3>
            <p>Complete health screening with 80+ tests included. Limited time.</p>
            <button class="btn btn-primary" data-route="#packages">Book Now</button>
          </div>
        </div>

        <div class="section-header">
          <h2>Popular Tests</h2>
          <a class="see-all" data-route="#search">See All</a>
        </div>
        <div class="test-grid" id="popularTests"></div>

        <div class="section-header">
          <h2>Health Packages</h2>
          <a class="see-all" data-route="#packages">See All</a>
        </div>
        <div class="packages-scroll" id="packagesScroll"></div>
      </section>

      <!-- Search Results -->
      <section id="search" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#home"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Search Tests</div>
        </div>
        <div class="search-container" style="padding-top:14px">
          <div class="search-bar">
            <i class="fa-solid fa-search"></i>
            <input id="searchInput2" type="text" placeholder="Search tests by name..." />
            <i class="fa-solid fa-sliders" id="openFilters"></i>
          </div>
        </div>
        <div class="tabs" id="searchSort">
          <div class="tab active" data-sort="relevance">Relevance</div>
          <div class="tab" data-sort="priceAsc">Price Low</div>
          <div class="tab" data-sort="priceDesc">Price High</div>
        </div>
        <div class="list" id="searchResults"></div>
      </section>

      <!-- Test Details -->
      <section id="test-details" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#search"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Test Details</div>
        </div>
        <div class="form" id="testDetailsContent"></div>
      </section>

      <!-- Categories -->
      <section id="categories" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#home"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Test Categories</div>
        </div>
        <div class="list" id="categoryList"></div>
      </section>

      <!-- Packages List -->
      <section id="packages" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#home"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Health Packages</div>
        </div>
        <div class="list" id="packagesList"></div>
      </section>

      <!-- Cart -->
      <section id="cart" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#home"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Your Cart</div>
        </div>
        <div class="list" id="cartList"></div>
        <div class="cta-bar">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
            <div><strong>Total:</strong> <span id="cartTotal">₹0</span></div>
            <button class="btn btn-outline" id="applyCouponBtn"><i class="fa-solid fa-tag"></i> Apply Coupon</button>
          </div>
          <button id="proceedToBook" class="btn btn-solid" style="width:100%">Proceed to Book</button>
        </div>
      </section>

      <!-- Select Patient -->
      <section id="select-patient" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#cart"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Select Patient</div>
        </div>
        <div class="list" id="patientsList"></div>
        <div class="cta-bar">
          <button class="btn btn-outline" data-route="#add-member" style="width:100%"><i class="fa-solid fa-user-plus"></i> Add Family Member</button>
          <div style="height:10px"></div>
          <button id="selectPatientContinue" class="btn btn-solid" style="width:100%">Continue</button>
        </div>
      </section>

      <!-- Add Family Member -->
      <section id="add-member" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#select-patient"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Add Family Member</div>
        </div>
        <div class="form">
          <div class="form-group"><label class="form-label">Name</label><input id="fmName" class="input" /></div>
          <div class="input-row">
            <div class="form-group" style="flex:1"><label class="form-label">Age</label><input id="fmAge" class="input" type="number"/></div>
            <div class="form-group" style="flex:1"><label class="form-label">Gender</label>
              <select id="fmGender" class="input"><option>Male</option><option>Female</option><option>Other</option></select>
            </div>
          </div>
          <div class="form-group"><label class="form-label">Relationship</label><input id="fmRel" class="input"/></div>
          <div class="form-group"><label class="form-label">Phone (optional)</label><input id="fmPhone" class="input" type="tel"/></div>
          <button id="saveFamily" class="btn btn-solid" style="width:100%">Save</button>
        </div>
      </section>

      <!-- Collection Type -->
      <section id="collection-type" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#select-patient"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Collection Type</div>
        </div>
        <div class="list">
          <div class="list-item select-collection" data-type="lab">
            <div class="icon"><i class="fa-solid fa-flask"></i></div>
            <div class="content">
              <div class="title">Visit Lab</div>
              <div class="subtitle">No extra charges</div>
            </div>
            <div class="badge badge-soft">₹0</div>
          </div>
          <div class="list-item select-collection" data-type="home">
            <div class="icon"><i class="fa-solid fa-house"></i></div>
            <div class="content">
              <div class="title">Home Collection</div>
              <div class="subtitle">Convenient at your address</div>
            </div>
            <div class="badge badge-soft">₹99</div>
          </div>
        </div>
        <div class="form" id="homeAddressBox" style="display:none">
          <div class="form-group"><label class="form-label">Home Collection Address</label><input id="hcAddress" class="input" placeholder="Address"/></div>
        </div>
        <div class="cta-bar">
          <button id="collectionContinue" class="btn btn-solid" style="width:100%">Continue</button>
        </div>
      </section>

      <!-- Date & Time Selection -->
      <section id="slot" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#collection-type"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Pick Date & Time</div>
        </div>
        <div class="calendar" id="calendarDays"></div>
        <div class="tabs" id="slotPartTabs">
          <div class="tab active" data-part="morning">Morning</div>
          <div class="tab" data-part="evening">Evening</div>
        </div>
        <div class="slots" id="slotTimes"></div>
        <div class="form"><label class="form-label">Special Instructions</label><textarea id="specialNotes" class="input" rows="3" placeholder="Any note for phlebotomist..."></textarea></div>
        <div class="cta-bar">
          <button id="slotContinue" class="btn btn-solid" style="width:100%">Continue</button>
        </div>
      </section>

      <!-- Review Booking -->
      <section id="booking-review" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#slot"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Review Booking</div>
        </div>
        <div class="form" id="reviewContent"></div>
        <div class="cta-bar">
          <button class="btn btn-outline" data-route="#cart" style="width:100%">Edit Cart</button>
          <div style="height:10px"></div>
          <button id="confirmBooking" class="btn btn-solid" style="width:100%">Confirm & Pay</button>
        </div>
      </section>

      <!-- Payment Methods -->
      <section id="payment" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#booking-review"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Payment</div>
        </div>
        <div class="list">
          <div class="list-item pay-method" data-method="pay-at-lab">
            <div class="icon"><i class="fa-solid fa-building-columns"></i></div>
            <div class="content"><div class="title">Pay at Lab</div><div class="subtitle">Cash/UPI at lab</div></div>
            <div class="badge badge-soft">No fee</div>
          </div>
          <div class="list-item pay-method" data-method="card">
            <div class="icon"><i class="fa-solid fa-credit-card"></i></div>
            <div class="content"><div class="title">Credit/Debit Card</div><div class="subtitle">Secure online payment</div></div>
            <div class="badge badge-soft">Online</div>
          </div>
          <div class="list-item pay-method" data-method="upi">
            <div class="icon"><i class="fa-solid fa-mobile-screen-button"></i></div>
            <div class="content"><div class="title">UPI/Wallets</div><div class="subtitle">Fast and easy</div></div>
            <div class="badge badge-soft">Online</div>
          </div>
        </div>
        <div class="cta-bar">
          <button id="payNow" class="btn btn-solid" style="width:100%">Pay</button>
        </div>
      </section>

      <!-- Booking Confirmation -->
      <section id="confirmation" class="screen hidden">
        <div class="form" style="text-align:center;padding-top:40px">
          <div class="logo-badge" style="width:76px;height:76px;background:linear-gradient(135deg,#2ecc71,#27ae60)"><i class="fa-solid fa-circle-check"></i></div>
          <h3 style="margin:12px 0 6px;font-weight:800">Booking Confirmed</h3>
          <p class="helper">Your booking ID is <strong id="confirmationId">#HL0001</strong></p>
          <div style="margin-top:14px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
            <button class="btn btn-outline" id="addToCalendar"><i class="fa-solid fa-calendar-plus"></i> Add to Calendar</button>
            <button class="btn btn-outline" id="shareBooking"><i class="fa-solid fa-share-nodes"></i> Share</button>
          </div>
          <div class="cta-bar" style="margin-top:16px">
            <button class="btn btn-solid" data-route="#bookings" style="width:100%">Go to Bookings</button>
          </div>
        </div>
      </section>

      <!-- My Bookings -->
      <section id="bookings" class="screen hidden">
        <div class="topbar">
          <div class="topbar-title" style="padding-left:8px">My Bookings</div>
        </div>
        <div class="tabs" id="bookingTabs">
          <div class="tab active" data-filter="upcoming">Upcoming</div>
          <div class="tab" data-filter="past">Past</div>
        </div>
        <div class="list" id="bookingsList"></div>
      </section>

      <!-- Booking Details -->
      <section id="booking-details" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#bookings"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Booking Details</div>
        </div>
        <div class="form" id="bookingDetailsContent"></div>
        <div class="cta-bar" id="bookingDetailsCta"></div>
      </section>

      <!-- Reports -->
      <section id="reports" class="screen hidden">
        <div class="topbar">
          <div class="topbar-title" style="padding-left:8px">Reports</div>
        </div>
        <div class="search-container" style="padding-top:12px">
          <div class="search-bar">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input id="reportSearch" placeholder="Search by date or test"/>
            <i class="fa-solid fa-filter"></i>
          </div>
        </div>
        <div class="list" id="reportsList"></div>
      </section>

      <!-- Report Details -->
      <section id="report-details" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#reports"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Report Details</div>
        </div>
        <div class="form" id="reportDetailsContent"></div>
        <div class="cta-bar">
          <button class="btn btn-outline" data-route="#report-pdf" style="width:100%"><i class="fa-solid fa-file-pdf"></i> View PDF</button>
        </div>
      </section>

      <!-- Report PDF Viewer (mock) -->
      <section id="report-pdf" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#report-details"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Report PDF</div>
        </div>
        <div class="empty">
          <i class="fa-solid fa-file-pdf"></i>
          <p>PDF preview placeholder. Implement real viewer in prod.</p>
          <div style="margin-top:10px;display:flex;gap:10px;justify-content:center">
            <button class="btn btn-outline"><i class="fa-solid fa-download"></i> Download</button>
            <button class="btn btn-outline"><i class="fa-solid fa-share"></i> Share</button>
          </div>
        </div>
      </section>

      <!-- Compare Reports -->
      <section id="compare-reports" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#reports"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Compare Reports</div>
        </div>
        <div class="form" id="compareReportsContent"></div>
      </section>

      <!-- Report History -->
      <section id="report-history" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#reports"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Report History</div>
        </div>
        <div class="list" id="reportHistoryList"></div>
      </section>

      <!-- Profile -->
      <section id="profile" class="screen hidden">
        <div class="topbar">
          <div class="topbar-title" style="padding-left:8px">Profile</div>
        </div>
        <div class="list">
          <div class="list-item">
            <div class="icon"><i class="fa-solid fa-user"></i></div>
            <div class="content">
              <div class="title" id="profileName">User</div>
              <div class="subtitle" id="profilePhone">+91</div>
            </div>
            <button class="btn btn-outline" data-route="#edit-profile">Edit</button>
          </div>

          <a class="list-item" data-route="#family">
            <div class="icon"><i class="fa-solid fa-people-roof"></i></div>
            <div class="content"><div class="title">Family Members</div><div class="subtitle">Manage your family</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#notifications">
            <div class="icon"><i class="fa-solid fa-bell"></i></div>
            <div class="content"><div class="title">Notifications</div><div class="subtitle">All notifications</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#offers">
            <div class="icon"><i class="fa-solid fa-tags"></i></div>
            <div class="content"><div class="title">Offers & Coupons</div><div class="subtitle">Apply coupons</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#payment-history">
            <div class="icon"><i class="fa-solid fa-receipt"></i></div>
            <div class="content"><div class="title">Payment History</div><div class="subtitle">Transactions and invoices</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#lab-locator">
            <div class="icon"><i class="fa-solid fa-location-dot"></i></div>
            <div class="content"><div class="title">Lab Locator</div><div class="subtitle">Find labs near you</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#notification-settings">
            <div class="icon"><i class="fa-solid fa-bell-slash"></i></div>
            <div class="content"><div class="title">Notification Settings</div><div class="subtitle">Manage alerts</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#privacy-settings">
            <div class="icon"><i class="fa-solid fa-user-shield"></i></div>
            <div class="content"><div class="title">Privacy Settings</div><div class="subtitle">Data sharing preferences</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#language">
            <div class="icon"><i class="fa-solid fa-language"></i></div>
            <div class="content"><div class="title">Change Language</div><div class="subtitle">Select your language</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#help">
            <div class="icon"><i class="fa-solid fa-circle-question"></i></div>
            <div class="content"><div class="title">Help & Support</div><div class="subtitle">FAQs & contact</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#terms">
            <div class="icon"><i class="fa-solid fa-file-contract"></i></div>
            <div class="content"><div class="title">Terms & Conditions</div><div class="subtitle">Read terms</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#privacy-policy">
            <div class="icon"><i class="fa-solid fa-user-lock"></i></div>
            <div class="content"><div class="title">Privacy Policy</div><div class="subtitle">Read policy</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <a class="list-item" data-route="#app-settings">
            <div class="icon"><i class="fa-solid fa-gear"></i></div>
            <div class="content"><div class="title">App Settings</div><div class="subtitle">Version, cache, updates</div></div>
            <i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>
          </a>

          <div class="list-item" id="logoutBtn">
            <div class="icon"><i class="fa-solid fa-arrow-right-from-bracket"></i></div>
            <div class="content"><div class="title">Logout</div><div class="subtitle">Sign out</div></div>
          </div>
        </div>
      </section>

      <!-- Edit Profile -->
      <section id="edit-profile" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Edit Profile</div>
        </div>
        <div class="form">
          <div class="form-group"><label class="form-label">Full Name</label><input id="epName" class="input"/></div>
          <div class="form-group"><label class="form-label">Phone</label><input id="epPhone" class="input"/></div>
          <div class="form-group"><label class="form-label">Email</label><input id="epEmail" class="input" type="email"/></div>
          <div class="form-group"><label class="form-label">Address</label><input id="epAddress" class="input"/></div>
          <button id="saveProfileBtn" class="btn btn-solid" style="width:100%">Save Changes</button>
        </div>
      </section>

      <!-- Family Members -->
      <section id="family" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Family Members</div>
        </div>
        <div class="list" id="familyList"></div>
        <div class="cta-bar">
          <button class="btn btn-solid" data-route="#add-member" style="width:100%"><i class="fa-solid fa-user-plus"></i> Add Member</button>
        </div>
      </section>

      <!-- Notification Settings -->
      <section id="notification-settings" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Notification Settings</div>
        </div>
        <div class="list" id="notifSettingsList"></div>
      </section>

      <!-- Privacy Settings -->
      <section id="privacy-settings" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Privacy Settings</div>
        </div>
        <div class="form">
          <div class="checkbox"><input id="shareData" type="checkbox"><label for="shareData">Allow anonymous data sharing</label></div>
          <div class="checkbox"><input id="reportVisibility" type="checkbox"><label for="reportVisibility">Allow family to view reports</label></div>
          <div class="helper" style="margin-top:10px">You can delete your account anytime.</div>
          <button class="btn btn-danger" id="deleteAccount" style="width:100%;margin-top:10px">Delete Account</button>
        </div>
      </section>

      <!-- Change Language -->
      <section id="language" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Change Language</div>
        </div>
        <div class="list" id="languageList"></div>
      </section>

      <!-- Help & Support -->
      <section id="help" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Help & Support</div>
        </div>
        <div class="list">
          <div class="list-item">
            <div class="icon"><i class="fa-solid fa-circle-question"></i></div>
            <div class="content"><div class="title">FAQs</div><div class="subtitle">Common questions</div></div>
          </div>
          <div class="list-item">
            <div class="icon"><i class="fa-solid fa-comments"></i></div>
            <div class="content"><div class="title">Chat Support</div><div class="subtitle">Start a chat</div></div>
          </div>
          <div class="list-item">
            <div class="icon"><i class="fa-solid fa-phone"></i></div>
            <div class="content"><div class="title">Call Support</div><div class="subtitle">+91 90000 00000</div></div>
          </div>
          <div class="list-item">
            <div class="icon"><i class="fa-solid fa-envelope"></i></div>
            <div class="content"><div class="title">Email Support</div><div class="subtitle">support@healthlab.app</div></div>
          </div>
        </div>
      </section>

      <!-- Notifications List -->
      <section id="notifications" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Notifications</div>
        </div>
        <div class="list" id="notificationsList"></div>
        <div class="cta-bar" style="display:flex;gap:10px">
          <button class="btn btn-outline" id="markAllRead" style="width:50%">Mark all read</button>
          <button class="btn btn-outline" id="clearAllNotif" style="width:50%">Clear all</button>
        </div>
      </section>

      <!-- Offers & Coupons -->
      <section id="offers" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Offers & Coupons</div>
        </div>
        <div class="list" id="offersList"></div>
      </section>

      <!-- Upload Prescription -->
      <section id="upload-rx" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#home"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Upload Prescription</div>
        </div>
        <div class="form" style="text-align:center">
          <div class="logo-badge" style="width:72px;height:72px;margin:10px auto"><i class="fa-solid fa-prescription-bottle-medical"></i></div>
          <input type="file" multiple id="rxFiles" accept="image/*,.pdf" class="input"/>
          <div class="helper">You can select multiple images or a PDF</div>
          <button id="uploadRxBtn" class="btn btn-solid" style="width:100%;margin-top:10px">Upload</button>
        </div>
      </section>

      <!-- Lab Locator -->
      <section id="lab-locator" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Lab Locator</div>
        </div>
        <div class="form">
          <div class="input-row">
            <input id="labSearch" class="input" placeholder="Search labs"/>
            <button id="toggleLabView" class="btn btn-outline"><i class="fa-solid fa-list"></i></button>
          </div>
        </div>
        <div id="mapMock" class="form" style="height:220px;background:linear-gradient(135deg,#e3f7f4,#e9f2ff);border:1px solid var(--border);border-radius:14px;margin:0 20px"></div>
        <div class="list" id="labsList"></div>
      </section>

      <!-- Rate & Review -->
      <section id="rate-review" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#bookings"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Rate & Review</div>
        </div>
        <div class="form" style="text-align:center">
          <div id="stars" style="font-size:28px;color:#ffb703;margin-bottom:12px">
            <i class="fa-regular fa-star"></i><i class="fa-regular fa-star"></i><i class="fa-regular fa-star"></i><i class="fa-regular fa-star"></i><i class="fa-regular fa-star"></i>
          </div>
          <div class="chips" style="justify-content:center;margin-bottom:10px">
            <div class="chip">Timing</div><div class="chip">Service</div><div class="chip">Hygiene</div><div class="chip">Pricing</div>
          </div>
          <textarea id="reviewText" class="input" rows="3" placeholder="Your feedback"></textarea>
          <button id="submitReview" class="btn btn-solid" style="width:100%;margin-top:10px">Submit</button>
        </div>
      </section>

      <!-- Refer & Earn -->
      <section id="refer-earn" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Refer & Earn</div>
        </div>
        <div class="form" style="text-align:center">
          <p class="helper">Share your code</p>
          <div class="badge badge-soft" id="refCode" style="font-size:16px;font-weight:800;padding:10px 14px">HL-REF-1234</div>
          <div style="margin-top:12px;display:flex;gap:10px;justify-content:center">
            <button class="btn btn-outline" id="shareRef"><i class="fa-solid fa-share"></i> Share</button>
            <button class="btn btn-outline" id="copyRef"><i class="fa-solid fa-copy"></i> Copy</button>
          </div>
          <div class="list" id="refHistory" style="margin-top:14px"></div>
        </div>
      </section>

      <!-- Payment History -->
      <section id="payment-history" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Payment History</div>
        </div>
        <div class="list" id="paymentHistoryList"></div>
      </section>

      <!-- Terms -->
      <section id="terms" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Terms & Conditions</div>
        </div>
        <div class="form" style="max-height:70vh;overflow:auto">
          <p class="helper">Scrollable T&C placeholder text...</p>
          <p style="margin-top:8px;line-height:1.6;color:#444">By using this app you agree to the following terms... (mock text)</p>
          <div style="height:10px"></div>
          <div class="checkbox"><input id="acceptTerms" type="checkbox"><label for="acceptTerms">I accept</label></div>
        </div>
      </section>

      <!-- Privacy Policy -->
      <section id="privacy-policy" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">Privacy Policy</div>
        </div>
        <div class="form" style="max-height:70vh;overflow:auto">
          <p class="helper">Last updated: 01 Oct 2025</p>
          <p style="margin-top:8px;line-height:1.6;color:#444">We take your privacy seriously... (mock text)</p>
        </div>
      </section>

      <!-- App Settings -->
      <section id="app-settings" class="screen hidden">
        <div class="topbar">
          <div class="back" data-route="#profile"><i class="fa-solid fa-chevron-left"></i></div>
          <div class="topbar-title">App Settings</div>
        </div>
        <div class="list">
          <div class="list-item">
            <div class="icon"><i class="fa-solid fa-code-branch"></i></div>
            <div class="content"><div class="title">App Version</div><div class="subtitle" id="appVersion">1.0.0</div></div>
          </div>
          <div class="list-item" id="clearCacheBtn">
            <div class="icon"><i class="fa-solid fa-broom"></i></div>
            <div class="content"><div class="title">Clear Cache</div><div class="subtitle">Remove local data</div></div>
          </div>
          <div class="list-item" id="checkUpdatesBtn">
            <div class="icon"><i class="fa-solid fa-arrows-rotate"></i></div>
            <div class="content"><div class="title">Check Updates</div><div class="subtitle">You are up to date</div></div>
          </div>
        </div>
      </section>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav" id="bottomNav">
      <div class="nav-items">
        <div class="nav-item active" data-route="#home"><i class="fa-solid fa-house"></i><span>Home</span></div>
        <div class="nav-item" data-route="#bookings"><i class="fa-solid fa-calendar-check"></i><span>Bookings</span></div>
        <div class="nav-item" data-route="#reports"><i class="fa-solid fa-file-lines"></i><span>Reports</span></div>
        <div class="nav-item" data-route="#profile"><i class="fa-solid fa-user"></i><span>Profile</span></div>
      </div>
    </div>
  </div>

  <!-- Modal (Filters, Cancel, Reschedule, etc.) -->
  <div class="modal-backdrop" id="modalBackdrop">
    <div class="modal" id="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Modal</div>
        <div class="close" id="modalClose"><i class="fa-solid fa-xmark"></i></div>
      </div>
      <div id="modalBody"></div>
      <div style="margin-top:12px;display:flex;gap:10px" id="modalFooter"></div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script>
    // Mock Data
    const TESTS = [
      {id:'cbc', name:'Complete Blood Count', price:399, tat:'6 hrs', fasting:false, sample:'Blood', prep:'No special preparation', desc:'Evaluates overall health and detects a wide range of disorders.'},
      {id:'thyroid', name:'Thyroid Profile', price:599, tat:'8 hrs', fasting:false, sample:'Blood', prep:'No special preparation', desc:'Checks T3, T4, TSH to assess thyroid function.'},
      {id:'diabetes', name:'Diabetes Panel', price:899, tat:'12 hrs', fasting:true, sample:'Blood', prep:'Overnight fasting recommended', desc:'Includes fasting blood sugar, HbA1c and more.'},
      {id:'lipid', name:'Lipid Profile', price:799, tat:'10 hrs', fasting:true, sample:'Blood', prep:'12-14 hours fasting recommended', desc:'Measures cholesterol types and triglycerides.'},
      {id:'lft', name:'Liver Function Test', price:699, tat:'10 hrs', fasting:false, sample:'Blood', prep:'Avoid alcohol 24 hrs before', desc:'Assesses liver enzymes and proteins.'},
      {id:'kft', name:'Kidney Function Test', price:749, tat:'10 hrs', fasting:false, sample:'Blood', prep:'Stay hydrated', desc:'Evaluates kidney health using various parameters.'}
    ];
    const PACKAGES = [
      {id:'pkg1', name:'Basic Health Checkup', tests:42, original:2999, discounted:1499, tags:['Free Home Collection','Report in 24 hrs']},
      {id:'pkg2', name:'Women\'s Wellness', tests:60, original:4999, discounted:2999, tags:['Hormone Profile','Nutritionist Consultation']},
      {id:'pkg3', name:'Full Body Checkup', tests:80, original:6999, discounted:3499, tags:['All major parameters','Doctor Review']}
    ];
    const CATEGORIES = [
      {id:'cat1', name:'General Health', count:24, icon:'fa-heart-pulse'},
      {id:'cat2', name:'Diabetes', count:12, icon:'fa-candy-cane'},
      {id:'cat3', name:'Thyroid', count:9, icon:'fa-shield'},
      {id:'cat4', name:'Liver', count:8, icon:'fa-burger'},
      {id:'cat5', name:'Kidney', count:7, icon:'fa-droplet'}
    ];
    const LABS = [
      {id:'lab1', name:'HealthLab Center - City Mall', distance:'1.2 km', phone:'+91 90000 00001', hours:'7 AM - 9 PM'},
      {id:'lab2', name:'HealthLab Diagnostic - North', distance:'3.5 km', phone:'+91 90000 00002', hours:'6 AM - 8 PM'},
      {id:'lab3', name:'HealthLab Express - West', distance:'5.8 km', phone:'+91 90000 00003', hours:'7 AM - 9 PM'}
    ];
    const OFFERS = [
      {code:'HL30', title:'30% OFF Full Body', desc:'On packages above ₹2999', tnC:'Valid till month end'},
      {code:'NEW100', title:'₹100 OFF for New Users', desc:'Min cart ₹699', tnC:'One-time use'}
    ];
    const NOTIFICATIONS = [
      {id:'n1', title:'Report Ready', body:'Your CBC report is now available', read:false},
      {id:'n2', title:'Limited Offer', body:'Get 30% OFF on Full Body Checkup', read:false},
      {id:'n3', title:'Booking Confirmed', body:'Your booking for 10:00 AM tomorrow is confirmed', read:true}
    ];
    const REPORTS = [
      {id:'r1', test:'CBC', date:'2025-10-01', normal:true, pdf:'cbc.pdf', params:[{name:'WBC', val:5.6, unit:'K/uL', range:'4.0-11.0'},{name:'RBC', val:4.8, unit:'M/uL', range:'4.2-5.9'}]},
      {id:'r2', test:'Lipid Profile', date:'2025-09-20', normal:false, pdf:'lipid.pdf', params:[{name:'Total Cholesterol', val:220, unit:'mg/dL', range:'<200'},{name:'HDL', val:40, unit:'mg/dL', range:'>40'}]},
      {id:'r3', test:'Thyroid (T3/T4/TSH)', date:'2025-08-15', normal:true, pdf:'thyroid.pdf', params:[{name:'TSH', val:2.1, unit:'mIU/L', range:'0.4-4.0'}]}
    ];

    // State
    const State = {
      route:'#splash',
      user:null,
      otpPhone:null,
      otpTimer:30,
      cart:[],
      coupon:null,
      selectedPatient:null,
      collectionType:'lab',
      homeAddress:'',
      slot:{date:null, time:null, part:'morning'},
      bookings:[],
      notifications:[...NOTIFICATIONS],
      reports:[...REPORTS],
      family:[],
      payments:[],
      refHistory:[{date:'2025-09-10', user:'Amit', earned:'₹50'},{date:'2025-09-28', user:'Sara', earned:'₹50'}]
    };

    // Utilities
    const $ = s => document.querySelector(s);
    const $$ = s => document.querySelectorAll(s);
    const storage = {
      save(){ localStorage.setItem('hl_state', JSON.stringify({
        user:State.user, cart:State.cart, coupon:State.coupon, selectedPatient:State.selectedPatient,
        bookings:State.bookings, notifications:State.notifications, reports:State.reports, family:State.family,
        payments:State.payments
      })); },
      load(){
        const raw = localStorage.getItem('hl_state');
        if(raw){
          try{
            const o = JSON.parse(raw);
            Object.assign(State, o);
          }catch{}
        }
      }
    };
    function toast(msg){
      const t = $('#toast'); t.textContent = msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1800);
    }
    function money(v){ return '₹'+Number(v||0).toLocaleString('en-IN'); }
    function genId(prefix='HL'){
      return `${prefix}${Math.random().toString(36).slice(2,6).toUpperCase()}`;
    }

    // Router
    const ROUTES_AUTH = new Set(['#splash','#onboarding','#login','#otp','#register','#location']);
    function showRoute(hash){
      if(!hash) hash = '#splash';
      State.route = hash;
      $$('.screen').forEach(el=>el.classList.add('hidden'));
      const id = hash.replace('#','');
      const screen = document.getElementById(id);
      if(screen) screen.classList.remove('hidden');

      // Bottom nav visibility
      $('#bottomNav').style.display = ROUTES_AUTH.has(hash) ? 'none' : 'block';
      // Set active nav
      $$('#bottomNav .nav-item').forEach(n=>{
        n.classList.toggle('active', n.getAttribute('data-route')===hash);
      });

      // Populate per-screen
      switch(hash){
        case '#home': renderHome(); break;
        case '#search': renderSearch(); break;
        case '#test-details': break;
        case '#categories': renderCategories(); break;
        case '#packages': renderPackagesList(); break;
        case '#cart': renderCart(); break;
        case '#select-patient': renderPatients(); break;
        case '#slot': renderSlot(); break;
        case '#booking-review': renderReview(); break;
        case '#bookings': renderBookings(); break;
        case '#booking-details': renderBookingDetails(); break;
        case '#reports': renderReports(); break;
        case '#report-details': renderReportDetails(); break;
        case '#compare-reports': renderCompareReports(); break;
        case '#report-history': renderReportHistory(); break;
        case '#profile': renderProfile(); break;
        case '#edit-profile': renderEditProfile(); break;
        case '#family': renderFamily(); break;
        case '#notification-settings': renderNotifSettings(); break;
        case '#notifications': renderNotifications(); break;
        case '#offers': renderOffers(); break;
        case '#lab-locator': renderLabs(); break;
        case '#payment-history': renderPaymentHistory(); break;
      }
    }
    window.addEventListener('hashchange', ()=>showRoute(location.hash));

    // Initial
    storage.load();
    document.addEventListener('DOMContentLoaded', ()=>{
      // Splash -> onboarding/login/home
      setTimeout(()=>{
        const firstRun = !localStorage.getItem('hl_seen_onboarding');
        if(firstRun) location.hash = '#onboarding';
        else if(State.user) location.hash = '#home';
        else location.hash = '#login';
      }, 1800);

      showRoute(location.hash || '#splash');
      bindGlobalActions();
      renderHome(); // pre-render
    });

    // Navigation helpers
    document.body.addEventListener('click', (e)=>{
      const routeEl = e.target.closest('[data-route]');
      if(routeEl){
        e.preventDefault();
        location.hash = routeEl.getAttribute('data-route');
      }
    });

    // Onboarding
    let slideIndex = 0;
    const slides = ()=> Array.from($('#slides')?.children || []);
    const dots = ()=> Array.from($('#dots')?.children || []);
    function setSlide(i){
      slideIndex = Math.max(0, Math.min(i, 2));
      slides().forEach((s,idx)=> s.classList.toggle('active', idx===slideIndex));
      dots().forEach((d,idx)=> d.classList.toggle('active', idx===slideIndex));
      if($('#nextSlide')) $('#nextSlide').textContent = (slideIndex===2 ? 'Get Started' : 'Next');
    }
    $('#prevSlide')?.addEventListener('click', ()=> setSlide(slideIndex-1));
    $('#nextSlide')?.addEventListener('click', ()=>{
      if(slideIndex<2) setSlide(slideIndex+1);
      else{
        localStorage.setItem('hl_seen_onboarding','1');
        location.hash = '#login';
      }
    });

    // Login
    $('#loginContinue')?.addEventListener('click', ()=>{
      const phone = $('#phone').value.trim();
      const cc = $('#countryCode').value;
      if(!$('#terms').checked) return toast('Please accept Terms & Privacy');
      if(!phone) return toast('Enter phone number');
      State.otpPhone = `${cc} ${phone}`;
      $('#otpPhoneLabel').textContent = `Enter the 6-digit code sent to ${State.otpPhone}`;
      startOtpTimer();
      location.hash = '#otp';
    });

    // OTP
    let otpInterval = null;
    function startOtpTimer(){
      State.otpTimer = 30;
      $('#otpTimer').textContent = `Resend in ${State.otpTimer}s`;
      $('#resendOtp').disabled = true;
      clearInterval(otpInterval);
      otpInterval = setInterval(()=>{
        State.otpTimer--;
        if(State.otpTimer<=0){
          clearInterval(otpInterval);
          $('#otpTimer').textContent = 'You can resend OTP';
          $('#resendOtp').disabled = false;
        }else{
          $('#otpTimer').textContent = `Resend in ${State.otpTimer}s`;
        }
      },1000);
      // clear inputs
      $$('#otp .otp input').forEach(i=>i.value='');
      const first = $$('#otp .otp input')[0]; first && first.focus();
    }
    // auto move
    $('#otp')?.addEventListener('input', (e)=>{
      const el = e.target;
      if(el.tagName==='INPUT' && el.maxLength==1 && el.value.length===1){
        const inputs = Array.from($$('#otp .otp input'));
        const idx = inputs.indexOf(el);
        if(idx<5) inputs[idx+1].focus();
        else el.blur();
      }
    });
    $('#resendOtp')?.addEventListener('click', ()=>{
      startOtpTimer(); toast('OTP resent');
    });
    $('#verifyOtp')?.addEventListener('click', ()=>{
      // mock verify success
      if(!State.user){
        // Ask registration or continue with minimal
        location.hash = '#register';
      }else{
        location.hash = '#location';
      }
    });

    // Register
    $('#regGender')?.addEventListener('click',(e)=>{
      const chip = e.target.closest('.chip'); if(!chip) return;
      $$('#regGender .chip').forEach(c=>c.classList.remove('active'));
      chip.classList.add('active');
    });
    $('#registerSubmit')?.addEventListener('click', ()=>{
      const name = $('#regName').value.trim();
      const email = $('#regEmail').value.trim();
      if(!name) return toast('Enter your name');
      State.user = {name, email, phone: State.otpPhone || '+91', address: $('#regAddress').value.trim(), dob: $('#regDob').value, gender: (document.querySelector('#regGender .chip.active')?.textContent||'')};
      storage.save();
      location.hash = '#location';
    });

    // Location
    $('#allowLocation')?.addEventListener('click', ()=>{
      // mock: set city
      $('#currentCity').textContent = 'Gohpur';
      toast('Location enabled'); location.hash = '#home';
    });
    $('#denyLocation')?.addEventListener('click', ()=>{
      $('#currentCity').textContent = 'Unknown'; toast('Location denied'); location.hash = '#home';
    });

    // Home
    function renderHome(){
      // greeting
      $('#greetingTitle').textContent = `Hi, ${State.user?.name?.split(' ')[0] || 'Guest'}! 👋`;
      if($('#currentCity').textContent==='Your location' && State.user?.address){
        $('#currentCity').textContent = State.user.address.split(',').slice(-1)[0].trim();
      }
      // popular tests
      const cont = $('#popularTests'); cont.innerHTML='';
      TESTS.slice(0,4).forEach((t,idx)=>{
        const div = document.createElement('div');
        div.className = 'test-card card';
        div.innerHTML = `
          <div class="test-icon"><i class="fa-solid ${['fa-droplet','fa-shield','fa-dna','fa-heart'][idx]||'fa-vial'}"></i></div>
          <div class="test-name">${t.name}</div>
          <div class="test-info">
            <span class="test-price">${money(t.price)}</span>
            <span class="test-time">${t.tat}</span>
          </div>`;
        div.addEventListener('click', ()=> openTestDetails(t.id));
        cont.appendChild(div);
      });
      // packages
      const ps = $('#packagesScroll'); ps.innerHTML='';
      PACKAGES.forEach((p,i)=>{
        const el = document.createElement('div');
        el.className = 'package-card '+(i%2===1?'secondary':'');
        el.innerHTML = `
          <div class="package-header">
            <div class="package-title">
              <h3>${p.name}</h3><p>${p.tests}+ tests included</p>
            </div>
            <div class="package-price">
              <div class="original">${money(p.original)}</div>
              <div class="discounted">${money(p.discounted)}</div>
            </div>
          </div>
          <div class="package-features">
            ${p.tags.map(t=>`<li><i class="fa-solid fa-check"></i> ${t}</li>`).join('')}
          </div>
          <div style="margin-top:10px;display:flex;gap:10px">
            <button class="btn btn-primary" data-id="${p.id}"><i class="fa-solid fa-cart-plus"></i> Add</button>
            <button class="btn btn-outline" data-id="${p.id}"><i class="fa-solid fa-circle-info"></i> Details</button>
          </div>
        `;
        el.querySelector('.btn-primary').addEventListener('click', ()=>{ addPackageToCart(p.id); });
        el.querySelector('.btn-outline').addEventListener('click', ()=>{ openPackageDetails(p.id); });
        ps.appendChild(el);
      });

      // header icons
      $('#notifBtn')?.addEventListener('click', ()=> location.hash = '#notifications');
      $('#searchInput')?.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ $('#searchInput2').value = e.target.value; location.hash='#search'; renderSearch(); }});
    }
    function openTestDetails(id){
      const t = TESTS.find(x=>x.id===id); if(!t) return;
      const c = $('#testDetailsContent');
      c.innerHTML = `
        <div class="card" style="padding:16px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 style="font-weight:800">${t.name}</h3>
            <div class="badge badge-soft">${money(t.price)}</div>
          </div>
          <div class="helper" style="margin:8px 0">${t.desc}</div>
          <div class="list" style="padding:0;margin-top:10px">
            <div class="list-item"><div class="icon"><i class="fa-solid fa-notes-medical"></i></div><div class="content"><div class="title">Preparation</div><div class="subtitle">${t.prep}</div></div></div>
            <div class="list-item"><div class="icon"><i class="fa-solid fa-utensils"></i></div><div class="content"><div class="title">Fasting</div><div class="subtitle">${t.fasting?'Required':'Not required'}</div></div></div>
            <div class="list-item"><div class="icon"><i class="fa-solid fa-vial"></i></div><div class="content"><div class="title">Sample Type</div><div class="subtitle">${t.sample}</div></div></div>
            <div class="list-item"><div class="icon"><i class="fa-solid fa-clock"></i></div><div class="content"><div class="title">Report Time</div><div class="subtitle">${t.tat}</div></div></div>
          </div>
          <div class="cta-bar">
            <button id="addToCartBtn" class="btn btn-solid" style="width:100%"><i class="fa-solid fa-cart-plus"></i> Add to Cart</button>
          </div>
        </div>`;
      $('#addToCartBtn').onclick = ()=>{ addTestToCart(t.id); };
      location.hash = '#test-details';
    }

    // Search
    let currentSort = 'relevance';
    function renderSearch(){
      const q = ($('#searchInput2').value||'').toLowerCase();
      let res = TESTS.filter(t=> t.name.toLowerCase().includes(q));
      if(currentSort==='priceAsc') res.sort((a,b)=>a.price-b.price);
      if(currentSort==='priceDesc') res.sort((a,b)=>b.price-a.price);
      const list = $('#searchResults'); list.innerHTML='';
      if(res.length===0){ list.innerHTML='<div class="empty"><i class="fa-solid fa-magnifying-glass"></i><p>No tests found</p></div>'; return; }
      res.forEach(t=>{
        const item = document.createElement('div');
        item.className='list-item';
        item.innerHTML = `
          <div class="icon"><i class="fa-solid fa-vial"></i></div>
          <div class="content"><div class="title">${t.name}</div><div class="subtitle">${t.fasting?'Fasting required • ':''}${t.tat}</div></div>
          <div style="text-align:right">
            <div class="title" style="color:var(--primary)">${money(t.price)}</div>
            <button class="btn btn-outline" data-id="${t.id}" style="margin-top:6px"><i class="fa-solid fa-cart-plus"></i></button>
          </div>`;
        item.querySelector('button').addEventListener('click', ()=> addTestToCart(t.id));
        item.addEventListener('click', (e)=>{ if(e.target.tagName==='BUTTON' || e.target.closest('button')) return; openTestDetails(t.id); });
        list.appendChild(item);
      });
      // sort tabs
      $$('#searchSort .tab').forEach(t=>{
        t.onclick = ()=>{ $$('#searchSort .tab').forEach(tt=>tt.classList.remove('active')); t.classList.add('active'); currentSort = t.dataset.sort; renderSearch(); }
      });
      $('#searchInput2').oninput = ()=> renderSearch();
      $('#openFilters').onclick = ()=> openModal('Filters', '<div class="chips"><div class="chip">Fasting</div><div class="chip">Non-fasting</div><div class="chip">Under ₹500</div></div>', [{label:'Apply', action:closeModal}]);
    }

    // Categories
    function renderCategories(){
      const list = $('#categoryList'); list.innerHTML='';
      CATEGORIES.forEach(c=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid ${c.icon}"></i></div><div class="content"><div class="title">${c.name}</div><div class="subtitle">${c.count} tests</div></div><i class="fa-solid fa-chevron-right" style="align-self:center;color:#bbb"></i>`;
        el.addEventListener('click', ()=>{ $('#searchInput2').value=c.name; location.hash='#search'; renderSearch(); });
        list.appendChild(el);
      });
    }

    // Packages
    function renderPackagesList(){
      const list = $('#packagesList'); list.innerHTML='';
      PACKAGES.forEach(p=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `
          <div class="icon"><i class="fa-solid fa-box-open"></i></div>
          <div class="content"><div class="title">${p.name}</div><div class="subtitle">${p.tests}+ tests • ${money(p.discounted)} <span style="text-decoration:line-through;opacity:.7;margin-left:6px">${money(p.original)}</span></div></div>
          <button class="btn btn-outline addPkg" data-id="${p.id}"><i class="fa-solid fa-cart-plus"></i></button>
        `;
        el.querySelector('.addPkg').onclick = ()=> addPackageToCart(p.id);
        list.appendChild(el);
      });
    }

    // Cart
    function addTestToCart(id){
      const t = TESTS.find(x=>x.id===id); if(!t) return;
      State.cart.push({type:'test', id, name:t.name, price:t.price});
      storage.save();
      toast('Added to cart');
      location.hash = '#cart'; renderCart();
    }
    function addPackageToCart(id){
      const p = PACKAGES.find(x=>x.id===id); if(!p) return;
      State.cart.push({type:'package', id, name:p.name, price:p.discounted});
      storage.save();
      toast('Package added to cart');
      location.hash = '#cart'; renderCart();
    }
    function renderCart(){
      const list = $('#cartList'); list.innerHTML='';
      if(State.cart.length===0){ list.innerHTML = '<div class="empty"><i class="fa-solid fa-cart-shopping"></i><p>Your cart is empty</p></div>'; }
      State.cart.forEach((it,idx)=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `
          <div class="icon"><i class="fa-solid ${it.type==='test'?'fa-vial':'fa-box-open'}"></i></div>
          <div class="content"><div class="title">${it.name}</div><div class="subtitle">${it.type.toUpperCase()}</div></div>
          <div style="text-align:right">
            <div class="title" style="color:var(--primary)">${money(it.price)}</div>
            <button class="btn btn-outline removeItem" data-idx="${idx}" style="margin-top:6px"><i class="fa-solid fa-trash"></i></button>
          </div>`;
        el.querySelector('.removeItem').onclick = (e)=>{ State.cart.splice(parseInt(e.target.closest('button').dataset.idx),1); storage.save(); renderCart(); };
        list.appendChild(el);
      });
      const total = State.cart.reduce((a,b)=>a+b.price,0) - (State.coupon?100:0);
      $('#cartTotal').textContent = money(total);
      $('#proceedToBook').onclick = ()=>{
        if(State.cart.length===0) return toast('Add items to cart');
        location.hash = '#select-patient';
      };
      $('#applyCouponBtn').onclick = ()=>{
        openModal('Apply Coupon', `
          <div class="form-group"><input id="couponCode" class="input" placeholder="Enter coupon code"></div>
          <div class="helper">Try: NEW100</div>
        `, [
          {label:'Cancel', action:closeModal},
          {label:'Apply', action:()=>{
            const c = $('#couponCode').value.trim().toUpperCase();
            if(c==='NEW100'){ State.coupon = {code:c, off:100}; toast('Coupon applied'); closeModal(); renderCart(); }
            else toast('Invalid coupon');
          }}
        ]);
      };
    }

    // Patients
    function renderPatients(){
      const list = $('#patientsList'); list.innerHTML='';
      // self
      const self = document.createElement('div');
      self.className = 'list-item';
      self.innerHTML = `<div class="icon"><i class="fa-solid fa-user"></i></div><div class="content"><div class="title">Self</div><div class="subtitle">${State.user?.name||'Yourself'}</div></div><input type="radio" name="patSel" ${!State.selectedPatient||State.selectedPatient==='self'?'checked':''} style="align-self:center">`;
      self.addEventListener('click', ()=> State.selectedPatient='self');
      list.appendChild(self);
      // family
      State.family.forEach((m,idx)=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-person"></i></div><div class="content"><div class="title">${m.name} (${m.gender}, ${m.age})</div><div class="subtitle">${m.relationship}</div></div><input type="radio" name="patSel" ${State.selectedPatient===idx?'checked':''} style="align-self:center">`;
        el.addEventListener('click', ()=> State.selectedPatient=idx);
        list.appendChild(el);
      });
      $('#selectPatientContinue').onclick = ()=> location.hash = '#collection-type';
    }
    $('#saveFamily')?.addEventListener('click', ()=>{
      const name = $('#fmName').value.trim(); const age = parseInt($('#fmAge').value||0);
      if(!name || !age) return toast('Enter name and age');
      State.family.push({name, age, gender:$('#fmGender').value, relationship:$('#fmRel').value||'Family', phone:$('#fmPhone').value||''});
      storage.save(); toast('Member added'); history.back();
    });

    // Collection Type
    $$('.select-collection').forEach(el=>{
      el.addEventListener('click', ()=> {
        $$('.select-collection').forEach(e=>e.classList.remove('selected'));
        el.classList.add('selected');
        State.collectionType = el.dataset.type;
        $('#homeAddressBox').style.display = (State.collectionType==='home')?'block':'none';
      });
    });
    $('#collectionContinue')?.addEventListener('click', ()=>{
      if(State.collectionType==='home'){
        State.homeAddress = $('#hcAddress').value.trim();
        if(!State.homeAddress) return toast('Enter home collection address');
      }
      location.hash = '#slot';
    });

    // Slots
    function daysArray(n=7){
      const arr=[]; const d=new Date();
      for(let i=0;i<n;i++){
        const dt = new Date(d.getFullYear(), d.getMonth(), d.getDate()+i);
        arr.push({date: dt.toISOString().slice(0,10), label: dt.toLocaleDateString(undefined,{weekday:'short', day:'numeric'})});
      }
      return arr;
    }
    function renderSlot(){
      const cal = $('#calendarDays'); cal.innerHTML='';
      const days = daysArray(10);
      days.forEach((d,idx)=>{
        const el = document.createElement('div');
        el.className = 'day'+(idx===0?' active':''); if(idx===0) State.slot.date = d.date;
        el.innerHTML = `<div style="font-weight:800">${d.label.split(' ')[0]}</div><div style="font-size:18px">${d.label.split(' ')[1]}</div>`;
        el.addEventListener('click', ()=>{
          $$('#calendarDays .day').forEach(x=>x.classList.remove('active')); el.classList.add('active'); State.slot.date = d.date;
        });
        cal.appendChild(el);
      });
      const timesMorning = ['07:30','08:00','08:30','09:00','09:30','10:00'];
      const timesEvening = ['16:00','16:30','17:00','17:30','18:00','18:30'];
      const slots = $('#slotTimes');
      function renderTimes(){
        slots.innerHTML='';
        const arr = (State.slot.part==='morning'?timesMorning:timesEvening);
        arr.forEach(t=>{
          const el = document.createElement('div'); el.className='slot'; el.textContent = t;
          el.addEventListener('click', ()=>{
            $$('#slotTimes .slot').forEach(s=>s.classList.remove('selected'));
            el.classList.add('selected'); State.slot.time = t;
          });
          slots.appendChild(el);
        });
      }
      renderTimes();
      $$('#slotPartTabs .tab').forEach(tab=>{
        tab.onclick = ()=>{ $$('#slotPartTabs .tab').forEach(t=>t.classList.remove('active')); tab.classList.add('active'); State.slot.part = tab.dataset.part; renderTimes(); };
      });
      $('#slotContinue').onclick = ()=>{
        if(!State.slot.time) return toast('Select a time slot');
        State.specialNotes = $('#specialNotes').value.trim();
        location.hash = '#booking-review';
      };
    }

    // Review
    function renderReview(){
      const c = $('#reviewContent');
      const items = State.cart.map(i=>`<li>${i.name} - <strong>${money(i.price)}</strong></li>`).join('');
      const total = State.cart.reduce((a,b)=>a+b.price,0);
      const disc = State.coupon?State.coupon.off:0;
      const grand = total + (State.collectionType==='home'?99:0) - disc;
      c.innerHTML = `
        <div class="card" style="padding:14px">
          <h3 style="font-weight:800;margin-bottom:8px">Patient</h3>
          <div class="helper">${State.selectedPatient==='self' ? (State.user?.name||'Self') : (State.family[State.selectedPatient]?.name||'Self')}</div>
        </div>
        <div class="card" style="padding:14px;margin-top:10px">
          <h3 style="font-weight:800;margin-bottom:8px">Tests</h3>
          <ul style="padding-left:16px;color:#444">${items}</ul>
        </div>
        <div class="card" style="padding:14px;margin-top:10px">
          <h3 style="font-weight:800;margin-bottom:8px">When & Where</h3>
          <div class="helper">${State.slot.date} at ${State.slot.time} • ${State.collectionType==='home'?'Home Collection':'Lab Visit'}</div>
          ${State.collectionType==='home'?`<div class="helper">Address: ${State.homeAddress}</div>`:''}
          ${State.specialNotes?`<div class="helper">Notes: ${State.specialNotes}</div>`:''}
        </div>
        <div class="card" style="padding:14px;margin-top:10px">
          <h3 style="font-weight:800;margin-bottom:8px">Price</h3>
          <div style="display:flex;justify-content:space-between"><span>Items</span><strong>${money(total)}</strong></div>
          <div style="display:flex;justify-content:space-between"><span>Home collection</span><strong>${money(State.collectionType==='home'?99:0)}</strong></div>
          <div style="display:flex;justify-content:space-between"><span>Coupon</span><strong>-${money(disc)}</strong></div>
          <hr style="border:none;border-top:1px dashed #e5e7eb;margin:8px 0">
          <div style="display:flex;justify-content:space-between;font-size:16px"><span>Total</span><strong>${money(grand)}</strong></div>
        </div>
      `;
      $('#confirmBooking').onclick = ()=> location.hash = '#payment';
    }

    // Payment
    let selectedPayment = 'pay-at-lab';
    $$('.pay-method').forEach(m=>{
      m.addEventListener('click', ()=>{
        $$('.pay-method').forEach(x=>x.classList.remove('selected'));
        m.classList.add('selected'); selectedPayment = m.dataset.method;
      });
    });
    $('#payNow')?.addEventListener('click', ()=>{
      // mock success
      const id = genId('BK');
      const booking = {
        id,
        createdAt: new Date().toISOString(),
        patient: State.selectedPatient==='self' ? (State.user?.name||'Self') : State.family[State.selectedPatient]?.name || 'Self',
        items:[...State.cart],
        when:{date:State.slot.date, time:State.slot.time},
        type: State.collectionType,
        address: State.collectionType==='home'?State.homeAddress:null,
        notes: State.specialNotes||'',
        amount: State.cart.reduce((a,b)=>a+b.price,0)+(State.collectionType==='home'?99:0)-(State.coupon?State.coupon.off:0),
        payment:{method:selectedPayment, status: selectedPayment==='pay-at-lab'?'pending':'paid'},
        status:'confirmed'
      };
      State.bookings.unshift(booking);
      State.payments.unshift({id:genId('PM'), bookingId:id, method:selectedPayment, amount:booking.amount, status:booking.payment.status, date: new Date().toISOString()});
      // clear cart for demo
      State.cart = []; State.coupon=null; storage.save();
      $('#confirmationId').textContent = '#'+id;
      location.hash = '#confirmation';
    });

    // Bookings
    let bookingFilter = 'upcoming';
    function renderBookings(){
      const list = $('#bookingsList'); list.innerHTML='';
      $$('#bookingTabs .tab').forEach(t=>{
        t.onclick = ()=>{ $$('#bookingTabs .tab').forEach(tt=>tt.classList.remove('active')); t.classList.add('active'); bookingFilter = t.dataset.filter; renderBookings(); };
      });
      const now = new Date();
      const data = State.bookings.filter(b=>{
        const dt = new Date(b.when.date+'T'+b.when.time+':00');
        return bookingFilter==='upcoming' ? dt>=now : dt<now;
      });
      if(data.length===0){ list.innerHTML = '<div class="empty"><i class="fa-solid fa-calendar-circle-plus"></i><p>No bookings here</p></div>'; return; }
      data.forEach(b=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `
          <div class="icon"><i class="fa-solid fa-calendar-check"></i></div>
          <div class="content">
            <div class="title">${b.items.map(i=>i.name).slice(0,1)} ${b.items.length>1?`+${b.items.length-1} more`:''}</div>
            <div class="subtitle">${b.when.date} at ${b.when.time} • ${b.type==='home'?'Home':'Lab'}</div>
          </div>
          <div style="text-align:right">
            <div class="title" style="color:var(--primary)">${money(b.amount)}</div>
            <button class="btn btn-outline" data-id="${b.id}" style="margin-top:6px"><i class="fa-solid fa-ellipsis"></i></button>
          </div>
        `;
        el.querySelector('button').onclick = ()=>{ openBookingDetails(b.id); };
        el.addEventListener('click', (e)=>{ if(e.target.tagName==='BUTTON'||e.target.closest('button')) return; openBookingDetails(b.id);});
        list.appendChild(el);
      });
    }
    function openBookingDetails(id){ location.hash = '#booking-details'; renderBookingDetails(id); }
    function renderBookingDetails(id){
      const b = State.bookings.find(x=>x.id===id) || State.bookings[0];
      if(!b) return;
      $('#bookingDetailsContent').innerHTML = `
        <div class="card" style="padding:14px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 style="font-weight:800">Booking ${b.id}</h3>
            <div class="badge badge-soft">${b.status}</div>
          </div>
          <div class="helper">Patient: ${b.patient}</div>
          <div class="helper">Date/Time: ${b.when.date} ${b.when.time}</div>
          <div class="helper">Type: ${b.type==='home'?'Home Collection':'Lab Visit'}</div>
          ${b.address?`<div class="helper">Address: ${b.address}</div>`:''}
          <div class="helper">Amount: ${money(b.amount)} • Payment: ${b.payment.status}</div>
        </div>
        <div class="card" style="padding:14px;margin-top:10px">
          <h3 style="font-weight:800;margin-bottom:6px">Tests</h3>
          <ul style="padding-left:16px;color:#444">${b.items.map(i=>`<li>${i.name} - <strong>${money(i.price)}</strong></li>`).join('')}</ul>
        </div>
      `;
      const cta = $('#bookingDetailsCta'); cta.innerHTML='';
      const when = new Date(b.when.date+'T'+b.when.time+':00');
      const canModify = (when - new Date()) > (2*60*60*1000);
      const cancelBtn = document.createElement('button'); cancelBtn.className='btn btn-outline'; cancelBtn.style.width='48%'; cancelBtn.textContent='Cancel';
      const resBtn = document.createElement('button'); resBtn.className='btn btn-solid'; resBtn.style.width='48%'; resBtn.textContent='Reschedule';
      cancelBtn.onclick = ()=> openCancelModal(b.id);
      resBtn.onclick = ()=> openRescheduleModal(b.id);
      if(canModify){ cta.appendChild(cancelBtn); cta.appendChild(resBtn); }
      else cta.innerHTML = '<div class="helper">Cannot modify within 2 hours of slot</div>';
    }
    function openCancelModal(id){
      openModal('Cancel Booking', `
        <div class="form-group"><label class="form-label">Reason</label><input id="cancelReason" class="input" placeholder="Optional"/></div>
        <div class="helper">Refunds for prepaid will be processed in 5-7 days.</div>
      `, [
        {label:'Keep', action:closeModal},
        {label:'Cancel', action:()=>{ const b = State.bookings.find(x=>x.id===id); if(b){ b.status='cancelled'; storage.save(); toast('Booking cancelled'); closeModal(); renderBookingDetails(); }}}
      ]);
    }
    function openRescheduleModal(id){
      openModal('Reschedule', `
        <div class="form-group"><label class="form-label">New Date</label><input id="rsDate" class="input" type="date"/></div>
        <div class="form-group"><label class="form-label">New Time</label><input id="rsTime" class="input" type="time"/></div>
      `, [
        {label:'Close', action:closeModal},
        {label:'Save', action:()=>{ const b = State.bookings.find(x=>x.id===id); if(b){ b.when.date=$('#rsDate').value||b.when.date; b.when.time=$('#rsTime').value||b.when.time; storage.save(); toast('Rescheduled'); closeModal(); renderBookingDetails(); }}}
      ]);
    }

    // Reports
    function renderReports(){
      const list = $('#reportsList'); list.innerHTML='';
      if(State.reports.length===0){ list.innerHTML = '<div class="empty"><i class="fa-solid fa-file-circle-xmark"></i><p>No reports</p></div>'; return;}
      State.reports.forEach(r=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `
          <div class="icon"><i class="fa-solid fa-file-medical"></i></div>
          <div class="content"><div class="title">${r.test}</div><div class="subtitle">${r.date} • ${r.normal?'Normal':'Abnormal'}</div></div>
          <div style="text-align:right">
            <button class="btn btn-outline" data-id="${r.id}" style="margin-top:6px"><i class="fa-solid fa-eye"></i></button>
          </div>`;
        el.querySelector('button').onclick = ()=> openReport(r.id);
        list.appendChild(el);
      });
      $('#reportSearch').oninput = (e)=>{
        const q = e.target.value.toLowerCase();
        Array.from(list.children).forEach(li=>{
          const t = li.querySelector('.title').textContent.toLowerCase();
          const s = li.querySelector('.subtitle').textContent.toLowerCase();
          li.style.display = (t.includes(q)||s.includes(q))?'flex':'none';
        });
      };
    }
    function openReport(id){
      const r = State.reports.find(x=>x.id===id); if(!r) return;
      const c = $('#reportDetailsContent');
      c.innerHTML = `
        <div class="card" style="padding:14px">
          <h3 style="font-weight:800">${r.test}</h3>
          <div class="helper">${r.date} • ${r.normal?'Within normal range':'Out of range'}</div>
        </div>
        <div class="card" style="padding:14px;margin-top:10px">
          <h3 style="font-weight:800;margin-bottom:8px">Results</h3>
          ${r.params.map(p=>`
            <div style="display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed #eef0f3">
              <div>
                <div style="font-weight:700">${p.name}</div>
                <div class="helper">Range: ${p.range}</div>
              </div>
              <div style="text-align:right"><div style="font-weight:800;color:${(p.alert?'var(--danger)':'#111')}">${p.val} ${p.unit}</div></div>
            </div>
          `).join('')}
        </div>
        <div class="card" style="padding:14px;margin-top:10px">
          <h3 style="font-weight:800;margin-bottom:8px">Trends</h3>
          <div class="helper">Graphical trends placeholder</div>
        </div>
      `;
      location.hash = '#report-details';
    }
    function renderCompareReports(){
      $('#compareReportsContent').innerHTML = `
        <div class="helper">Select 2-3 reports to compare (mock)</div>
        <div class="chips" id="cmpChips" style="margin-top:8px">${State.reports.map(r=>`<div class="chip" data-id="${r.id}">${r.test} (${r.date})</div>`).join('')}</div>
        <div class="card" style="padding:14px;margin-top:10px"><div class="helper">Trend graphs placeholder</div></div>
      `;
      $('#cmpChips').addEventListener('click', (e)=>{
        const chip = e.target.closest('.chip'); if(!chip) return;
        chip.classList.toggle('active');
      });
    }
    function renderReportHistory(){
      const list = $('#reportHistoryList'); list.innerHTML='';
      State.reports.forEach(r=>{
        const el=document.createElement('div');
        el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-clock-rotate-left"></i></div><div class="content"><div class="title">${r.test}</div><div class="subtitle">${r.date}</div></div>`;
        list.appendChild(el);
      });
    }

    // Profile
    function renderProfile(){
      $('#profileName').textContent = State.user?.name || 'Guest';
      $('#profilePhone').textContent = State.user?.phone || '+91';
      $('#logoutBtn').onclick = ()=>{
        openModal('Logout','<div class="helper">Are you sure you want to logout?</div>',[
          {label:'Cancel', action:closeModal},
          {label:'Logout', action:()=>{ State.user=null; storage.save(); closeModal(); location.hash='#login'; }}
        ]);
      };
    }
    function renderEditProfile(){
      $('#epName').value = State.user?.name || '';
      $('#epPhone').value = State.user?.phone || '';
      $('#epEmail').value = State.user?.email || '';
      $('#epAddress').value = State.user?.address || '';
      $('#saveProfileBtn').onclick = ()=>{
        State.user = { ...(State.user||{}), name:$('#epName').value, phone:$('#epPhone').value, email:$('#epEmail').value, address:$('#epAddress').value };
        storage.save(); toast('Profile updated'); history.back();
      };
    }
    function renderFamily(){
      const list = $('#familyList'); list.innerHTML='';
      if(State.family.length===0){ list.innerHTML = '<div class="empty"><i class="fa-solid fa-people-group"></i><p>No family members yet</p></div>'; return; }
      State.family.forEach((m,idx)=>{
        const el = document.createElement('div');
        el.className='list-item';
        el.innerHTML = `
          <div class="icon"><i class="fa-solid fa-person"></i></div>
          <div class="content"><div class="title">${m.name} (${m.gender}, ${m.age})</div><div class="subtitle">${m.relationship}</div></div>
          <button class="btn btn-outline del" data-idx="${idx}"><i class="fa-solid fa-trash"></i></button>
        `;
        el.querySelector('.del').onclick = ()=>{ State.family.splice(idx,1); storage.save(); renderFamily(); };
        list.appendChild(el);
      });
    }
    function renderNotifSettings(){
      const list = $('#notifSettingsList'); list.innerHTML='';
      const items = [
        {id:'sms', title:'SMS Notifications'},
        {id:'email', title:'Email Notifications'},
        {id:'app', title:'App Notifications'},
        {id:'promo', title:'Promotional Messages'}
      ];
      items.forEach(i=>{
        const el=document.createElement('div'); el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-bell"></i></div><div class="content"><div class="title">${i.title}</div><div class="subtitle">Toggle on/off</div></div><input type="checkbox" style="align-self:center">`;
        list.appendChild(el);
      });
    }

    // Notifications, Offers
    function renderNotifications(){
      const list = $('#notificationsList'); list.innerHTML='';
      if(State.notifications.length===0){ list.innerHTML = '<div class="empty"><i class="fa-solid fa-bell-slash"></i><p>No notifications</p></div>'; return; }
      State.notifications.forEach(n=>{
        const el = document.createElement('div');
        el.className = 'list-item';
        el.style.opacity = n.read?0.6:1;
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-bell"></i></div><div class="content"><div class="title">${n.title}</div><div class="subtitle">${n.body}</div></div>`;
        el.addEventListener('click', ()=>{ n.read=true; storage.save(); renderNotifications(); });
        list.appendChild(el);
      });
      $('#markAllRead').onclick = ()=>{ State.notifications.forEach(n=>n.read=true); storage.save(); renderNotifications(); };
      $('#clearAllNotif').onclick = ()=>{ State.notifications=[]; storage.save(); renderNotifications(); };
    }
    function renderOffers(){
      const list = $('#offersList'); list.innerHTML='';
      OFFERS.forEach(o=>{
        const el=document.createElement('div'); el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-tag"></i></div><div class="content"><div class="title">${o.title}</div><div class="subtitle">${o.desc} • Code: ${o.code}</div></div><button class="btn btn-outline">Apply</button>`;
        el.querySelector('button').onclick = ()=>{ State.coupon={code:o.code, off: o.code==='NEW100'?100:200}; storage.save(); toast('Coupon applied'); };
        list.appendChild(el);
      });
    }

    // Labs
    let labListView = true;
    function renderLabs(){
      $('#mapMock').textContent = labListView ? 'Map Preview (mock)' : 'Map Hidden';
      $('#toggleLabView').innerHTML = labListView ? '<i class="fa-solid fa-location-dot"></i>' : '<i class="fa-solid fa-list"></i>';
      const list = $('#labsList'); list.innerHTML='';
      LABS.forEach(l=>{
        const el = document.createElement('div'); el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-flask"></i></div><div class="content"><div class="title">${l.name}</div><div class="subtitle">${l.distance} • ${l.hours}</div></div><div><button class="btn btn-outline" style="margin-bottom:6px"><i class="fa-solid fa-phone"></i></button><button class="btn btn-outline"><i class="fa-solid fa-diamond-turn-right"></i></button></div>`;
        list.appendChild(el);
      });
      $('#toggleLabView').onclick = ()=>{ labListView = !labListView; renderLabs(); };
      $('#labSearch').oninput = (e)=>{
        const q = e.target.value.toLowerCase();
        Array.from(list.children).forEach(li=>{
          const t=li.querySelector('.title').textContent.toLowerCase(); li.style.display = t.includes(q)?'flex':'none';
        });
      };
    }

    // Payment History
    function renderPaymentHistory(){
      const list = $('#paymentHistoryList'); list.innerHTML='';
      if(State.payments.length===0){ list.innerHTML='<div class="empty"><i class="fa-solid fa-receipt"></i><p>No transactions yet</p></div>'; return; }
      State.payments.forEach(p=>{
        const el = document.createElement('div'); el.className='list-item';
        el.innerHTML = `<div class="icon"><i class="fa-solid fa-receipt"></i></div><div class="content"><div class="title">Payment ${p.id} • ${p.method.toUpperCase()}</div><div class="subtitle">${new Date(p.date).toLocaleString()} • ${p.status}</div></div><div class="title" style="color:var(--primary)">${money(p.amount)}</div>`;
        list.appendChild(el);
      });
    }

    // Refer & Earn actions
    $('#shareRef')?.addEventListener('click', ()=> toast('Share sheet (mock)'));
    $('#copyRef')?.addEventListener('click', ()=> { navigator.clipboard.writeText($('#refCode').textContent); toast('Copied'); });

    // Modals
    function openModal(title, bodyHtml, actions=[]){
      $('#modalTitle').textContent = title;
      $('#modalBody').innerHTML = bodyHtml;
      const foot = $('#modalFooter'); foot.innerHTML='';
      actions.forEach(a=>{
        const b = document.createElement('button'); b.className = 'btn '+(a.danger?'btn-danger':'btn-solid'); b.textContent = a.label; b.onclick = a.action || closeModal; foot.appendChild(b);
      });
      $('#modalBackdrop').style.display='flex';
    }
    function closeModal(){ $('#modalBackdrop').style.display='none'; }
    $('#modalClose').addEventListener('click', closeModal);
    $('#modalBackdrop').addEventListener('click', (e)=>{ if(e.target.id==='modalBackdrop') closeModal(); });

    // Global binds
    function bindGlobalActions(){
      // bottom nav
      $$('#bottomNav .nav-item').forEach(i=> i.addEventListener('click', ()=> location.hash = i.getAttribute('data-route')));

      // header notification button already bound in renderHome
      // category see-all etc handled by data-route
      // app settings
      $('#clearCacheBtn')?.addEventListener('click', ()=>{ localStorage.clear(); toast('Cache cleared'); setTimeout(()=>location.reload(),600); });
      $('#checkUpdatesBtn')?.addEventListener('click', ()=> toast('You are on latest version'));
    }

    function openPackageDetails(id){
      const p = PACKAGES.find(x=>x.id===id);
      if(!p) return;
      openModal(p.name, `
        <div class="helper">${p.tests}+ tests included</div>
        <ul style="margin-top:8px;color:#444"><li>General Health</li><li>Liver & Kidney</li><li>Thyroid</li><li>Diabetes</li></ul>
      `, [{label:'Close', action:closeModal},{label:'Add to Cart', action:()=>{ addPackageToCart(id); closeModal(); }}]);
    }

    // Notifications icon -> route
    $('#notifBtn')?.addEventListener('click', ()=> location.hash='#notifications');

    // Rate & Review (open from booking details after completion in a real app)
    $('#submitReview')?.addEventListener('click', ()=>{ toast('Thanks for your feedback'); history.back(); });
    // Simple star selection
    $('#stars')?.addEventListener('click', (e)=>{
      if(e.target.tagName!=='I') return;
      const idx = Array.from($('#stars').children).indexOf(e.target);
      Array.from($('#stars').children).forEach((s,i)=> s.className = i<=idx? 'fa-solid fa-star' : 'fa-regular fa-star');
    });

    // Share booking
    $('#shareBooking')?.addEventListener('click', ()=> toast('Share booking (mock)'));
    $('#addToCalendar')?.addEventListener('click', ()=> toast('Added event (mock)'));
  </script>
</body>
</html>